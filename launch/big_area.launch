<!--
Provides a reasonable set of parameters for running Karto on a robot
Assumes an 'odom_combined' frame, that provides reasonably accurate odometry
-->

<launch>

  <!--include file="$(find odometry_modifier)/launch/odom_modifier.launch"/-->

  <node pkg="slam_karto" type="slam_karto" name="slam_karto" output="screen">

    <remap from="scan" to="base_scan"/>
    <param name="odom_frame" value="odom"/>
    <param name="map_update_interval" value="5.0"/>

    <!-- Karto parameters -->
    <param name="resolution" value="0.025"/>
    <param name="use_scan_matching" value="true"/>
    <param name="use_scan_barycenter" value="true"/>
    <param name="minimum_travel_distance" value="0.5"/>
    <param name="minimum_travel_heading" value="0.35"/>
    <param name="scan_buffer_size" value="30"/>
    <param name="scan_buffer_max_scan_distance" value="20"/>
    <param name="link_match_min_response_fine" value="0.3"/>
    <param name="link_scan_max_distance" value="5"/>
    <param name="loop_search_max_distance" value="4.0"/>
    <param name="do_loop_closing" value="true"/>
    <param name="loop_match_min_chain_size" value="8"/>
    <param name="loop_match_max_variance_coarse" value="0.3"/>
    <param name="loop_match_min_response_coarse" value="0.3"/>
    <param name="loop_match_min_response_fine" value="0.4"/>
    <param name="corr_search_space_dim" value="0.3"/>
    <param name="corr_search_space_res" value="0.01"/>
    <param name="corr_search_space_smear_dev" value="0.03"/>
    <param name="loop_search_space_dim" value="4"/>
    <param name="loop_search_space_res" value="0.05"/>
    <param name="loop_search_space_smear_dev" value="0.03"/>
    <param name="distance_variance_penalty" value="0.09"/>
    <param name="angle_variance_penalty" value="0.121846967914683"/>
    <param name="fine_search_angle_offset" value="0.00349065850398866"/>
    <param name="coarse_search_angle_offset" value="0.349065850398866"/>
    <param name="coarse_angle_resolution" value="0.0349065850398866"/>
    <param name="minimum_angle_penalty" value="0.9"/>
    <param name="minimum_dist_penalty" value="0.5"/>
    <param name="use_response_expansion" value="true"/>

    <!-- SLAM Karto ROS parameters -->
    <param name="solver_type" value="SWITCHABLE"/>
    <param name="map_frame" value="map"/>
    <param name="odom_frame" value="odom"/>

    <!-- G2O only -->
    <param name="use_interactive_switches" value="true"/>
    <param name="calibration_mode" value="true"/>
    <param name="g2o_online_optimization" value="false"/>
    <param name="g2o_num_iterations" value="30"/>
    <param name="calibration_mode" value="true"/>

  </node>
</launch>
